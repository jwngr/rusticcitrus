!function(){"use strict";function e(){$("#unplayableViewStateWarning img").on("dragstart",function(e){e.preventDefault()}),WinJS.Namespace.define("RC",{Facebook:FBWinJS}),RC.Facebook.options({appId:"533987136687889"}),Firebase.INTERNAL.forceWebSockets(),RC.firebaseRoot=RC.useDevFirebaseRoot?new Firebase("https://rusticcitrus.firebaseio.com/dev"):new Firebase("https://rusticcitrus.firebaseio.com/prod"),RC.smallestNumLetters=5,RC.defaultRoundLengthInSeconds=120,RC.firebaseRoot.child("users/0/").once("value",function(e){RC.loggedInUser=e.val(),RC.loggedInUser.id=e.name();var n=$("#loginContainer");n.find("img").attr("src",RC.loggedInUser.imageUrl),n.find(".name").text(RC.loggedInUser.firstName+" "+RC.loggedInUser.lastName),n.find(".username").text(RC.loggedInUser.username)}),WinJS.Namespace.defineWithParent(RC,"Music",{mainMenuMusic:$("#mainMenuMusic")[0],gameBoardMusic:$("#gameBoardMusic")[0],musicOn:void 0,soundEffectsOn:void 0}),RC.Music.mainMenuMusic.volume=.2,RC.Music.gameBoardMusic.volume=.1,s(),a(),r(),RC.debug?(RC.HighScores.deleteFile_DEBUG(RC.HighScores.load),RC.Achievements.deleteFile_DEBUG(RC.Achievements.load),o(u.start())):(RC.HighScores.load(),RC.Achievements.load(),u.start())}function n(){var e=d.values.soundOptions;if(e)$("#musicToggleSwitch")[0].winControl.checked=e.musicOn,$("#soundEffectsToggleSwitch")[0].winControl.checked=e.soundEffectsOn,RC.Music.musicOn=e.musicOn,RC.Music.soundEffectsOn=e.soundEffectsOn;else{var n=new Windows.Storage.ApplicationDataCompositeValue;n.musicOn=!0,n.soundEffectsOn=!0,d.values.soundOptions=n,$("#musicToggleSwitch")[0].winControl.checked=!0,$("#soundEffectsToggleSwitch")[0].winControl.checked=!0,RC.Music.musicOn=!0,RC.Music.soundEffectsOn=!0}}function t(){$("#musicToggleSwitch")[0].winControl.onchange=function(){var e=new Windows.Storage.ApplicationDataCompositeValue;e.musicOn=$("#musicToggleSwitch")[0].winControl.checked,e.soundEffectsOn=RC.Music.soundEffectsOn,d.values.soundOptions=e,RC.Music.musicOn=!RC.Music.musicOn,RC.Music.musicOn?"/html/gameBoard.html"==WinJS.Navigation.location?(RC.Music.gameBoardMusic.currentTime=0,RC.Music.gameBoardMusic.play()):(RC.Music.mainMenuMusic.currentTime=0,RC.Music.mainMenuMusic.play()):(RC.Music.mainMenuMusic.pause(),RC.Music.gameBoardMusic.pause())},$("#soundEffectsToggleSwitch")[0].winControl.onchange=function(){var e=new Windows.Storage.ApplicationDataCompositeValue;e.musicOn=RC.Music.musicOn,e.soundEffectsOn=$("#soundEffectsToggleSwitch")[0].winControl.checked,d.values.soundOptions=e,RC.Music.soundEffectsOn=!RC.Music.soundEffectsOn},RC.licenseInformation.isTrial&&$("#resetGame").hide(),$("#resetGameDataButton").on("click",function(){confirmResetDataFlyout.winControl.show($(this)[0],"bottom","left")}),$("#cancelResetDataButton").on("click",function(){confirmResetDataFlyout.winControl.hide()}),$("#confirmResetDataButton").on("click",function(){RC.Games.reset(),RC.HighScores.reset(),RC.Achievements.reset(),confirmResetDataFlyout.winControl.hide()})}function o(e){var n=new Windows.Foundation.Uri("ms-appx:///resources/files/firebaseData.json");Windows.Storage.StorageFile.getFileFromApplicationUriAsync(n).then(function(n){Windows.Storage.FileIO.readTextAsync(n).then(function(n){RC.firebaseRoot.child("users").set(JSON.parse(n),function(){e&&e()})})})}function s(){RC.currentApp=RC.useDebugLicense?Windows.ApplicationModel.Store.CurrentAppSimulator:Windows.ApplicationModel.Store.CurrentApp,RC.licenseInformation=RC.currentApp.licenseInformation,RC.licenseInformation.addEventListener("licensechanged",i),RC.licenseInformation.isActive||RC.MessageDialogs.displayAppPurchaseDialog("Your trial version has expired","Your trial period for Rustic Citrus has expired. Please purchase the full game to continue the addictive, jumbled madness and get extra features like 7-letter games, high scores, achievements, and saved games!",!1)}function i(){RC.licenseInformation.isActive||RC.MessageDialogs.displayAppPurchaseDialog("Your trial version has expired","Your trial period for Rustic Citrus has expired. Please purchase the full game to continue the addictive, jumbled madness and get extra features like 7-letter games, high scores, achievements, and saved games!",!1)}function a(){var e=Windows.ApplicationModel.Background;e.BackgroundExecutionManager.requestAccessAsync().then(function(n){if(RC.debug)switch(n){case e.BackgroundAccessStatus.denied:console.log('This user clicked "Don\'t allow" and the app is not allowed on the lock screen.');break;case e.BackgroundAccessStatus.allowedWithAlwaysOnRealTimeConnectivity:console.log("This app is on the lock screen, can set up background tasks, and has access to the Real Time Connectivity broker.");break;case e.BackgroundAccessStatus.allowedMayUseActiveRealTimeConnectivity:console.log("This app is on the lock screen, can set up background tasks, but does not have access to the Real Time Connectivity broker.");break;case e.BackgroundAccessStatus.unspecified:console.log("The user has not yet taken any action. This is the default setting and the app is not on the lock screen.")}},function(e){RC.debug&&console.error(e)})}function r(){for(var e="updateLiveTileBackgroundTask",n=Windows.ApplicationModel.Background.BackgroundTaskRegistration.allTasks.first();n.hasCurrent;){var t=n.current.value;t.name===e&&t.unregister(!0),n.moveNext()}var o=new Windows.ApplicationModel.Background.BackgroundTaskBuilder;o.name=e,o.taskEntryPoint="updateLiveTileBackgroundTask.js";var s=new Windows.ApplicationModel.Background.SystemCondition(Windows.ApplicationModel.Background.SystemConditionType.internetAvailable);o.addCondition(s);var i=new Windows.ApplicationModel.Background.TimeTrigger(15,!1);o.setTrigger(i),o.register()}WinJS.Binding.optimizeBindingReferences=!0;var c=WinJS.Navigation,u=WinJS.Application;Windows.Storage.ApplicationData.current.localFolder;var d=Windows.Storage.ApplicationData.current.localSettings;WinJS.Namespace.define("RC",{debug:!0,useDebugLicense:!1,useDevFirebaseRoot:!0,assert:function(e,n){RC.debug&&!e&&console.error(n)}}),u.onactivated=function(e){e.detail.kind===Windows.ApplicationModel.Activation.ActivationKind.launch&&(e.detail.previousExecutionState!==Windows.ApplicationModel.Activation.ApplicationExecutionState.terminated||u.sessionState.history&&(c.history=u.sessionState.history),e.setPromise(WinJS.UI.processAll().then(function(){return n(),t(),c.location?(c.history.current.initialPlaceholder=!0,c.navigate(c.location,c.state)):c.navigate(Application.navigator.home)})))},u.oncheckpoint=function(){if(u.sessionState.history=c.history,RC.currentGame){var e=RC.currentGame,n=e.currentRound;RC.debug&&(console.assert("object"==typeof e,"currentGame is not an object"),console.assert("object"==typeof n,"currentRound is not an object"),console.assert("number"==typeof e.score,"score is not a number"),console.assert("number"==typeof e.numLetters,"numLetters is not a number"),console.assert("number"==typeof e.numRoundsCompleted,"numRoundsCompleted is not a number"),console.assert("number"==typeof e.numWordsFound,"numWordsFound is not a number"),console.assert("number"==typeof n.secondsRemaining,"secondsRemaining is not a number"),console.assert("string"==typeof n.word,"currentRoundWord is not a string"),console.assert("object"==typeof e.pastRoundWords,"pastRoundWords is not an object"),console.assert("number"==typeof e.numConsecutivePerfectRounds,"numConsecutivePerfectRounds is not a number"),console.assert("string"==typeof e.dateCreated,"dateCreated is not a string"),console.assert("object"==typeof n.foundWords,"foundWords is not an object"),"object"!=typeof e||"object"!=typeof n||"number"!=typeof e.score||"number"!=typeof e.numLetters||"number"!=typeof e.numRoundsCompleted||"number"!=typeof e.numWordsFound||"number"!=typeof n.secondsRemaining||"string"!=typeof n.word||"object"!=typeof e.pastRoundWords||"number"!=typeof e.numConsecutivePerfectRounds||"string"!=typeof e.dateCreated||"object"!=typeof n.foundWords);var t={numLetters:e.numLetters,score:e.score,numRoundsCompleted:e.numRoundsCompleted,numWordsFound:e.numWordsFound,pastRoundWords:e.pastRoundWords,dateCreated:e.dateCreated,dateModified:(new Date).toString(),numConsecutivePerfectRounds:e.numConsecutivePerfectRounds,currentRoundWord:n.word,secondsRemaining:n.secondsRemaining,foundWords:n.foundWords};u.sessionState.history.current.state={mode:"load",startRoundPaused:!0,startRoundDone:0==n.secondsRemaining,game:t}}},u.onsettings=function(e){e.detail.applicationcommands={optionsSettingsFlyout:{title:"Options",href:"/html/default.html"},helpSettingsFlyout:{title:"Help",href:"/html/default.html"},creditsSettingsFlyout:{title:"Credits",href:"/html/default.html"},privacyPolicySettingsFlyout:{title:"Privacy Policy",href:"/html/default.html"}},WinJS.UI.SettingsFlyout.populateSettings(e)},u.onerror=function(e){return RC.debug&&console.error(e.detail.errorMessage),!1},document.addEventListener("DOMContentLoaded",e,!1)}();